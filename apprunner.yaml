version: 1.0
runtime: nodejs18
build:
  commands:
    pre-build:
      - echo "Installing dependencies..."
      - cd backend
      - npm ci
    build:
      - echo "Building application..."
      - npm run build
    post-build:
      - echo "Build completed successfully!"
      
run:
  runtime-version: 18
  command: cd backend && npm start
  network:
    port: 5000
    env: APP_PORT
  env:
    - name: NODE_ENV
      value: "production"
    - name: PORT
      value: "5000"
    - name: FRONTEND_URL
      value: "https://stmg7szp76.eu-west-1.awsapprunner.com"
    # DATABASE_URL wird 체ber AWS Console / CLI gesetzt (enth채lt Passwort!)
    - name: DB_SSL
      value: "true"
    # OPENAI_API_KEY wird 체ber AWS Console / CLI gesetzt (nicht in Git!)
    - name: OPENAI_MODEL
      value: "gpt-4o-mini"
    - name: OPENAI_CONTENT_FILTER
      value: "true"
    - name: OPENAI_ALLOW_EXPLICIT
      value: "false"
    # JWT_SECRET wird 체ber AWS Console / CLI gesetzt
    - name: WHATSAPP_TYPING_DELAY
      value: "true"

